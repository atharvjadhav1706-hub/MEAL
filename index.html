<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Pro FitHub: Elite Checklist</title>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
    :root {
        --bg: #050505;
        --card: #141414;
        
        /* PALETTE */
        --c-pink: #FF2D55;
        --c-blue: #00F0FF;
        --c-orange: #FF9F0A;
        --c-purple: #BF5AF2;
        --c-green: #30D158;
        
        --text: #ffffff;
        --font: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Segoe UI", Roboto, sans-serif;
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; user-select: none; }

    body {
        font-family: var(--font);
        background-color: var(--bg);
        color: var(--text);
        margin: 0; padding: 0;
        padding-bottom: 120px;
    }

    /* --- ANIMATIONS --- */
    @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes pulseGlow { 0%{box-shadow: 0 0 0px var(--card-color);} 50%{box-shadow: 0 0 15px var(--card-color);} 100%{box-shadow: 0 0 0px var(--card-color);} }

    /* --- GLOBAL UI --- */
    .page { display: none; padding: 20px; padding-top: 90px; } 
    .page.active { display: block; animation: slideUp 0.4s cubic-bezier(0.2, 0.8, 0.2, 1); }

    /* --- HEADER --- */
    .glass-header {
        position: fixed; top: 0; left: 0; right: 0; height: 70px;
        background: rgba(5, 5, 5, 0.95); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(255,255,255,0.1); z-index: 100;
        display: flex; align-items: center; justify-content: space-between; padding: 0 20px;
    }
    .gh-title { font-size: 1.1rem; font-weight: 800; letter-spacing: 1px; color: #fff; text-transform: uppercase; }
    .gh-btn { background: #222; width: 40px; height: 40px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; cursor: pointer; border: 1px solid #333; }

    /* --- HERO --- */
    .hero-big {
        background: linear-gradient(145deg, #1a1a1a, #0f0f0f);
        border-radius: 32px; padding: 25px; margin-bottom: 25px;
        border: 1px solid rgba(255,255,255,0.08); position: relative; overflow: hidden;
        box-shadow: 0 20px 50px -10px rgba(0,0,0,0.6);
    }
    .hero-flex { display: flex; justify-content: space-between; align-items: center; position: relative; z-index: 2; }
    .cal-number { font-size: 3.8rem; font-weight: 900; line-height: 0.9; color: #fff; letter-spacing: -2px; }
    .cal-label { font-size: 0.8rem; font-weight: 700; color: #666; margin-top: 10px; letter-spacing: 1px; text-transform: uppercase; }
    
    .target-box { 
        background: rgba(255,255,255,0.05); color: #fff; border: 1px solid #333;
        padding: 5px 12px; border-radius: 20px; display: inline-block; margin-top: 10px; font-size: 0.8rem; font-weight: 800; 
    }
    .target-val { background: linear-gradient(to right, var(--c-pink), var(--c-blue), var(--c-green)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

    /* --- RING CHART --- */
    .ring-wrapper { width: 110px; height: 110px; position: relative; display: flex; align-items: center; justify-content: center; }
    .c-chart { transform: rotate(-90deg); width: 100%; height: 100%; }
    .c-bg { fill: none; stroke: #222; stroke-width: 8; }
    .c-fill { 
        fill: none; stroke-width: 8; stroke-linecap: round; 
        stroke: url(#rainbowGrad); 
        stroke-dasharray: 251; stroke-dashoffset: 251; 
        transition: stroke-dashoffset 1s cubic-bezier(0.4,0,0.2,1);
        filter: drop-shadow(0 0 5px rgba(255,255,255,0.3));
    }
    .ring-icon { position: absolute; font-size: 2rem; }

    /* --- STATS --- */
    .stats-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
    .stat-box { 
        background: #111; border-radius: 24px; padding: 20px; height: 130px; 
        display: flex; flex-direction: column; justify-content: space-between; 
        border: 1px solid #222; transition: 0.2s;
    }
    .stat-box:active { transform: scale(0.98); background: #161616; }
    .sb-icon { font-size: 1.5rem; }
    .sb-val { font-size: 1.5rem; font-weight: 800; color: #fff; }
    .sb-label { font-size: 0.7rem; font-weight: 800; color: #555; text-transform: uppercase; }
    .w-bar-bg { width: 100%; height: 6px; background: #222; border-radius: 10px; overflow: hidden; margin-top: 8px; }
    .w-bar-fill { height: 100%; width: 0%; background: var(--c-blue); border-radius: 10px; transition: width 0.5s; box-shadow: 0 0 10px var(--c-blue); }

    /* --- MENU --- */
    .menu-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
    .menu-btn { 
        background: #111; height: 100px; border-radius: 24px; border: 1px solid #222;
        display: flex; flex-direction: column; align-items: center; justify-content: center;
        gap: 8px; font-weight: 700; color: #888; font-size: 0.8rem; transition: 0.2s;
    }
    .menu-btn:active { background: #181818; transform: scale(0.98); }

    /* --- MEAL CARD --- */
    .meal-section-title { font-size: 1.5rem; font-weight: 900; margin-bottom: 20px; color: #fff; letter-spacing: 0.5px; }
    
    .meal-card {
        background: #121212; border-radius: 24px; padding: 20px; margin-bottom: 16px;
        position: relative; border: 1px solid #1f1f1f; overflow: hidden; transition: 0.3s; 
    }
    .meal-card::before { content:''; position:absolute; left:0; top:0; bottom:0; width:5px; background: var(--card-color); opacity:0.8; }

    /* HIGHLIGHT */
    .meal-card.highlight {
        border: 1px solid var(--card-color);
        animation: pulseGlow 2s infinite;
        transform: scale(1.02); z-index: 10;
        background: #181818;
    }
    .next-badge {
        position: absolute; top: 0; right: 0;
        background: var(--card-color); color: #000;
        font-size: 0.6rem; font-weight: 900; padding: 4px 10px;
        border-bottom-left-radius: 12px; display: none;
    }
    .meal-card.highlight .next-badge { display: block; }

    /* CHECKED STATE */
    .meal-card.checked { opacity: 0.6; filter: grayscale(0.5); border-color: #222; }
    .meal-card.checked .check-box { background: var(--card-color); border-color: var(--card-color); color: #000; }

    /* HEADER ROW */
    .mc-header { 
        display: flex; justify-content: space-between; align-items: center; 
        margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid #222; 
    }
    .mc-time { font-size: 0.75rem; font-weight: 800; text-transform: uppercase; color: var(--card-color); letter-spacing: 1px; }
    
    /* RIGHT SIDE ACTIONS */
    .mc-actions { display: flex; align-items: center; gap: 10px; }
    .mc-cal { font-weight: 700; font-size: 0.9rem; color: #fff; background: #222; padding: 4px 8px; border-radius: 6px; }
    
    /* THE CHECKBOX */
    .check-box {
        width: 28px; height: 28px; border-radius: 8px;
        border: 2px solid #444; background: transparent;
        display: flex; align-items: center; justify-content: center;
        color: transparent; font-size: 1.1rem; font-weight: 900;
        transition: 0.2s; cursor: pointer;
    }

    /* TITLE */
    .mc-title { font-size: 1.2rem; font-weight: 800; color: #fff; margin-bottom: 15px; }

    /* INGREDIENT TABLE */
    .ing-list { display: flex; flex-direction: column; gap: 8px; }
    .ing-row { 
        display: flex; justify-content: space-between; align-items: center; 
        padding: 10px; background: rgba(255,255,255,0.03); border-radius: 10px;
    }
    .ing-name { font-size: 0.95rem; font-weight: 600; color: #ddd; display: flex; align-items: center; gap: 10px; }
    .ing-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--card-color); }
    .ing-weight { 
        font-size: 0.85rem; font-weight: 800; color: #000; 
        background: var(--card-color); padding: 3px 10px; border-radius: 6px; 
    }

    /* --- INPUTS --- */
    .floating-btn { width: 100%; padding: 20px; background: #fff; border-radius: 20px; color: #000; font-weight: 900; font-size: 1rem; border: none; margin-top: 20px; }
    input { width: 100%; padding: 20px; background: #000; border: 1px solid #333; border-radius: 18px; color: #fff; font-size: 1rem; font-weight: 600; margin-bottom: 15px; }
</style>
</head>
<body onload="init()">

<svg style="position: absolute; width: 0; height: 0;">
  <defs>
    <linearGradient id="rainbowGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:var(--c-pink);stop-opacity:1" />
      <stop offset="50%" style="stop-color:var(--c-blue);stop-opacity:1" />
      <stop offset="100%" style="stop-color:var(--c-green);stop-opacity:1" />
    </linearGradient>
  </defs>
</svg>

<canvas id="confetti" style="position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:9999;"></canvas>

<div class="glass-header">
    <div class="gh-btn" onclick="if(document.getElementById('p-home').classList.contains('active')) nav('p-set'); else nav('p-home');">‚Üê</div>
    <div class="gh-title" id="pageTitle">DASHBOARD</div>
    <div class="gh-btn" onclick="nav('p-set')">‚öôÔ∏è</div>
</div>

<div id="p-home" class="page active">
    
    <div class="hero-big" onclick="nav('p-meal')">
        <div class="hero-flex">
            <div>
                <div class="cal-number" id="dispCal">0</div>
                <div class="cal-label">CALORIES TODAY</div>
                <div class="target-box">TARGET: <span id="dispTarget" class="target-val">2450</span></div>
            </div>
            <div class="ring-wrapper">
                <svg viewBox="0 0 100 100" class="c-chart">
                    <circle class="c-bg" cx="50" cy="50" r="40" />
                    <circle class="c-fill" id="progCirc" cx="50" cy="50" r="40" />
                </svg>
                <div class="ring-icon">üî•</div>
            </div>
        </div>
        <div style="margin-top:20px; background:rgba(255,255,255,0.05); padding:10px 15px; border-radius:15px; display:flex; justify-content:space-between; align-items:center;">
            <div style="font-size:0.75rem; color:#888; font-weight:700;">NEXT MEAL</div>
            <div style="font-size:0.9rem; color:#fff; font-weight:800;" id="homeNextMeal">Finding...</div>
        </div>
    </div>

    <div class="stats-row">
        <div class="stat-box" onclick="nav('p-water')">
            <div><div class="sb-icon">üíß</div><div class="sb-label">Hydration</div></div>
            <div><div class="sb-val" id="dispWater">0.0L</div><div class="w-bar-bg"><div class="w-bar-fill" id="barWater"></div></div></div>
        </div>
        <div class="stat-box" style="border-color: #222;">
            <div><div class="sb-icon">‚ö°</div><div class="sb-label">Streak</div></div>
            <div class="sb-val" id="dispStreak" style="color:#fff">0</div>
        </div>
    </div>

    <div class="menu-grid">
        <div class="menu-btn" onclick="nav('p-shop')"><span style="color:var(--c-orange)">üõí</span> Shopping</div>
        <div class="menu-btn" onclick="nav('p-hist')"><span style="color:var(--c-purple)">üìÖ</span> History</div>
        <div class="menu-btn" onclick="nav('p-calc')"><span style="color:var(--c-blue)">‚ûï</span> Custom</div>
        <div class="menu-btn" onclick="nav('p-set')"><span style="color:var(--c-pink)">‚öô</span> Settings</div>
    </div>
</div>

<div id="p-meal" class="page">
    <h1 class="meal-section-title">Today's Fuel</h1>
    <div id="mealList"></div>
    <h3 style="color:#666; margin-top:40px; text-transform:uppercase; letter-spacing:1px; font-size:0.8rem;">Custom Logs</h3>
    <div id="custList"></div>
    <button class="floating-btn" onclick="nav('p-calc')">+ ADD CUSTOM ENTRY</button>
</div>

<div id="p-water" class="page">
    <div style="text-align:center; padding-top:40px;">
        <div style="font-size:6rem; font-weight:900; color:var(--c-blue); line-height:1;" id="waterLg">0.0</div>
        <div style="font-weight:800; color:#555; letter-spacing:2px; margin-top:10px;">LITERS TODAY</div>
        <div style="display:flex; justify-content:center; gap:20px; margin-top:60px;">
            <button onclick="modWater(-250)" style="width:80px; height:80px; border-radius:24px; background:#1a1a1a; border:1px solid #333; color:#fff; font-size:2rem;">-</button>
            <button onclick="modWater(250)" style="width:80px; height:80px; border-radius:24px; background:var(--c-blue); border:none; color:#000; font-size:2rem;">+</button>
        </div>
    </div>
</div>

<div id="p-shop" class="page">
    <h1 class="meal-section-title">Tomorrow's List</h1>
    <div style="background:#111; padding:20px; border-radius:24px; border:1px solid #222;" id="shopList"></div>
</div>

<div id="p-hist" class="page">
    <h1 class="meal-section-title">History</h1>
    <div style="background:#111; padding:20px; border-radius:24px; border:1px solid #222;" id="histRows"></div>
</div>

<div id="p-calc" class="page">
    <div style="background:#111; padding:30px; border-radius:30px; border:1px solid #222;">
        <input id="cName" type="text" placeholder="Item Name">
        <input id="cCal" type="number" placeholder="Calories">
        <button class="floating-btn" onclick="addCust()">ADD TO LOG</button>
    </div>
</div>

<div id="p-set" class="page">
    <div style="background:#111; padding:30px; border-radius:30px; border:1px solid #222;">
        <label style="font-size:0.7rem; font-weight:800; color:#666; margin-bottom:10px; display:block;">TARGET CALORIES</label>
        <input id="sTarg" type="number">
        <button class="floating-btn" onclick="saveSet()">SAVE SETTINGS</button>
        <button class="floating-btn" style="background:#220000; color:#ff4444; margin-top:10px;" onclick="reset()">RESET APP</button>
    </div>
</div>

<script>
/* DATA (24HR TIME) */
const scientificPlan = [
    { 
        t:530, l:"5:30 AM", n:"Pre-Workout", c:105, color: "var(--c-green)", 
        items: [
            {n:"Banana", w:"1 Medium"},
            {n:"Black Coffee", w:"1 Cup"}
        ]
    },
    { 
        t:815, l:"8:15 AM", n:"Breakfast", c:480, color: "var(--c-pink)", 
        items: [
            {n:"Whey Protein", w:"1 Scoop"},
            {n:"Oats", w:"80g"},
            {n:"Pumpkin Seeds", w:"15g"}
        ]
    },
    { 
        t:1330, l:"1:30 PM", n:"Lunch", c:750, color: "var(--c-blue)", 
        items: [
            {n:"Wheat Flour", w:"100g"},
            {n:"Soya Chunks", w:"70g"},
            {n:"Salad/Cucumber", w:"1 Bowl"}
        ]
    },
    { 
        t:1630, l:"4:30 PM", n:"Snack", c:300, color: "var(--c-orange)", 
        items: [
            {n:"Roasted Chana", w:"50g"},
            {n:"Apple", w:"1 Pc"}
        ]
    },
    { 
        t:2030, l:"8:30 PM", n:"Dinner", c:600, color: "var(--c-purple)", 
        items: [
            {n:"Wheat Flour", w:"70g"},
            {n:"Green Moong", w:"40g"},
            {n:"Kabuli Chana", w:"40g"}
        ]
    }
];

let app = { target: 2450, baseStreak: 0, lastLogDate: "", checks: {}, water: 0, custom: [], hist: [] };
let nextMealIndex = -1;

function init() {
    if(localStorage.getItem('elite_chk_v3')) app = JSON.parse(localStorage.getItem('elite_chk_v3'));
    
    const today = new Date().toDateString();
    if(app.lastLogDate && app.lastLogDate !== today) {
        let cal = calculateTotal();
        if(cal > 0) {
            let met = cal >= (app.target - 400);
            let dObj = new Date(app.lastLogDate);
            app.hist.unshift({d: dObj.getDate() + " " + dObj.toLocaleString('default', { month: 'short' }), c: cal, m: met});
            if(app.hist.length > 7) app.hist.pop();
            app.baseStreak = met ? app.baseStreak + 1 : 0;
        }
        app.checks = {}; app.water = 0; app.custom = [];
    }
    app.lastLogDate = today;
    
    // TIME SYNC
    const now = new Date();
    const currentMins = now.getHours() * 100 + now.getMinutes(); 
    
    nextMealIndex = -1;
    for(let i=0; i<scientificPlan.length; i++) {
        if(scientificPlan[i].t > currentMins) {
            nextMealIndex = i;
            break;
        }
    }
    if(nextMealIndex === -1 && currentMins > 2030) nextMealIndex = -1; 
    if(nextMealIndex === -1 && currentMins < 500) nextMealIndex = 0; 
    
    const homeTxt = document.getElementById('homeNextMeal');
    if(nextMealIndex !== -1) {
        homeTxt.innerText = scientificPlan[nextMealIndex].n + " (" + scientificPlan[nextMealIndex].l + ")";
        homeTxt.style.color = scientificPlan[nextMealIndex].color;
    } else {
        homeTxt.innerText = "All Done ‚úÖ";
        homeTxt.style.color = "#888";
    }

    save(); render(); shopRender();
}

function calculateTotal() {
    let cal = 0;
    scientificPlan.forEach((f, i) => { if(app.checks[i]) cal += f.c; });
    app.custom.forEach(c => cal += c.c);
    return cal;
}

function render() {
    let cal = 0;
    const mList = document.getElementById('mealList'); mList.innerHTML = "";
    
    scientificPlan.forEach((f, i) => {
        let isChk = app.checks[i] ? 'checked' : '';
        let isNext = (i === nextMealIndex && !isChk) ? 'highlight' : ''; 
        if(app.checks[i]) cal += f.c;
        
        let ingHtml = f.items.map(item => `
            <div class="ing-row">
                <div class="ing-name"><div class="ing-dot"></div>${item.n}</div>
                <div class="ing-weight">${item.w}</div>
            </div>
        `).join('');

        mList.innerHTML += `
        <div class="meal-card ${isChk} ${isNext}" id="meal-${i}" style="--card-color:${f.color}" onclick="togMeal(${i})">
            <div class="next-badge">NEXT UP</div>
            
            <div class="mc-header">
                <div class="mc-time">${f.l}</div>
                <div class="mc-actions">
                    <div class="mc-cal">${f.c} kcal</div>
                    <div class="check-box">‚úì</div>
                </div>
            </div>
            
            <div class="mc-title">${f.n}</div>
            
            <div class="ing-list">
                ${ingHtml}
            </div>
        </div>`;
    });
    
    const cList = document.getElementById('custList'); cList.innerHTML = "";
    app.custom.forEach((c, i) => { cal += c.c; cList.innerHTML += `<div class="meal-card checked" style="--card-color:#fff; border-color:#333"><div class="mc-header"><div class="mc-time">CUSTOM</div><div class="mc-actions"><div class="mc-cal">${c.c}</div><div onclick="delCust(${i})" style="color:red; font-weight:900;">‚úï</div></div></div><div class="mc-title">${c.n}</div></div>`; });

    document.getElementById('dispCal').innerText = cal;
    let pct = Math.min(1, cal/app.target);
    document.getElementById('progCirc').style.strokeDashoffset = 251 - (251 * pct);
    document.getElementById('waterLg').innerText = (app.water/1000).toFixed(1);
    document.getElementById('dispWater').innerText = (app.water/1000).toFixed(1) + "L";
    document.getElementById('barWater').style.width = Math.min(100, (app.water/6000)*100) + "%";
    document.getElementById('histRows').innerHTML = app.hist.length ? app.hist.map(h=>`<div style="display:flex; justify-content:space-between; padding:15px; border-bottom:1px solid #222; color:#888;"><span>${h.d}</span><span>${h.c} kcal</span></div>`).join('') : '<div style="text-align:center; color:#444; padding:20px;">No Data</div>';
    save();
}

function shopRender() {
    let allItems = [];
    scientificPlan.forEach(meal => { 
        meal.items.forEach(item => allItems.push({name: item.n, w: item.w, color: meal.color})); 
    });
    document.getElementById('shopList').innerHTML = allItems.map(item => `
        <div style="display:flex; justify-content:space-between; padding:15px; border-bottom:1px solid #222;" onclick="this.style.opacity='0.3'">
            <span style="color:#fff; font-weight:700;">${item.name}</span>
            <span style="color:${item.color}; font-weight:800;">${item.w}</span>
        </div>
    `).join('');
}

function togMeal(i) {
    if(app.checks[i]) delete app.checks[i];
    else { 
        app.checks[i] = true; 
        // CONFETTI TRIGGER
        confetti({
            particleCount: 150,
            spread: 80,
            origin: { y: 0.6 },
            colors: ['#FF2D55', '#00F0FF', '#FF9F0A', '#30D158']
        });
    }
    render();
}

function nav(id) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    
    if(id === 'p-meal' && nextMealIndex !== -1) {
        setTimeout(() => {
            const el = document.getElementById(`meal-${nextMealIndex}`);
            if(el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, 100); 
    }
    window.scrollTo(0,0);
}

function modWater(n) { app.water += n; if(app.water < 0) app.water = 0; render(); }
function addCust() { let n = document.getElementById('cName').value, c = parseInt(document.getElementById('cCal').value); if(n&&c){app.custom.push({n,c}); nav('p-meal'); render();} }
function delCust(i) { event.stopPropagation(); app.custom.splice(i,1); render(); }
function saveSet() { app.target = parseInt(document.getElementById('sTarg').value); render(); nav('p-home'); }
function reset() { if(confirm("Delete Data?")) { localStorage.removeItem('elite_chk_v3'); location.reload(); } }
function save() { localStorage.setItem('elite_chk_v3', JSON.stringify(app)); }

init();
</script>
</body>
</html>
